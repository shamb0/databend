# AND filter short circuit
statement ok
drop table if exists t;

statement ok
create table t(a int null, b varchar null);

statement ok
insert into t(a, b) values (3, NULL), (3,'hello'), (3,'hello'), (3,'hello'), (3,'hello'), (3,'hello'), (3,'hello'), (3,'hello'), (1,'4'), (1,'4');

query I
select a, b from t where a = 1 and cast(b as int) >= 2;
----
1 4
1 4

# OR filter short circuit
statement ok
drop table if exists t;

statement ok
create table t(a int);

statement ok
insert into t values(0), (1), (2), (3), (NULL)

query I
select a from t where a = 0 or 3 / a > 2 order by a
----
0
1

statement ok
drop table if exists t;

# Boolean comparison
statement ok
drop table if exists t;

statement ok
create table t(a boolean, b boolean);

statement ok
insert into t values(true, true), (true, false), (false, false);

query I
select count(*) from t where a > b;
----
1

query II
select count(*) from t where a >= b;
----
3

query III
select count(*) from t where a < b;
----
0

query I?
select count(*) from t where a <= b;
----
2

statement ok
drop table if exists t;

# Like Test
statement ok
drop table if exists t;

statement ok
create table t(a int, b varchar);

statement ok
insert into t values(1, 'databend'), (2, ' databend query'), (3, 'query databend'), (4, 'query databend, query'), (5, 'databend cloud data warehouse'), (6, 'databend%cloud data warehouse');

# LikePattern::OrdinalStr
query I
select * from t where b like 'databend';
----
1 databend

# LikePattern::StartOfPercent
query I
select * from t where b like '%databend';
----
1 databend
3 query databend

# LikePattern::EndOfPercent
query I
select * from t where b like 'databend%';
----
1 databend
5 databend cloud data warehouse
6 databend%cloud data warehouse

# LikePattern::SurroundByPercent
query I
select * from t where b like '%databend%';
----
1 databend
2  databend query
3 query databend
4 query databend, query
5 databend cloud data warehouse
6 databend%cloud data warehouse

# LikePattern::ComplexPattern
query I
select * from t where b like 'databend\\%cloud%data%warehouse';
----
6 databend%cloud data warehouse

# LikePattern::ComplexPattern
query I
select * from t where b like 'databend%cloud_data%warehouse';
----
5 databend cloud data warehouse
6 databend%cloud data warehouse

# LikePattern::SimplePattern, has_start_percent = false, has_end_percent = false
query I
select * from t where b like 'databend%cloud%data%warehouse';
----
5 databend cloud data warehouse
6 databend%cloud data warehouse

# LikePattern::SimplePattern, has_start_percent = true, has_end_percent = false
query I
select * from t where b like '%databend%cloud%data%warehouse';
----
5 databend cloud data warehouse
6 databend%cloud data warehouse

# LikePattern::SimplePattern, has_start_percent = false, has_end_percent = true
query I
select * from t where b like 'databend%cloud%data%warehouse%';
----
5 databend cloud data warehouse
6 databend%cloud data warehouse

# LikePattern::SimplePattern, has_start_percent = true, has_end_percent = true
query I
select * from t where b like '%databend%cloud%data%warehouse%';
----
5 databend cloud data warehouse
6 databend%cloud data warehouse

# LikePattern::StartOfPercent, push down not
query I
select * from t where b not like '%databend';
----
2  databend query
4 query databend, query
5 databend cloud data warehouse
6 databend%cloud data warehouse

# LikePattern::SimplePattern, has_start_percent = false, has_end_percent = false, push down not
query I
select * from t where b not like 'databend%cloud%data%warehouse';
----
1 databend
2  databend query
3 query databend
4 query databend, query
