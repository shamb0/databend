statement ok
drop table if exists map_cat_test all

statement ok
CREATE TABLE map_cat_test(id int, map1 variant, map2 variant)

statement ok
INSERT INTO map_cat_test(id, map1, map2) VALUES (1, parse_json('{"key1": "value1", "key2": "value2"}'), parse_json('{"key3": "value3", "key4": "value4"}')),
                                                (2, parse_json('{"a": 1, "b": 2}'), parse_json('{"c": 3, "d": 4}')),
                                                (3, parse_json('{"x": "hello", "y": "world"}'), parse_json('{"z": "!", "alice": "cream"}'));

query
SELECT * FROM map_cat_test LIMIT 3;
----
1 {"key1":"value1","key2":"value2"} {"key3":"value3","key4":"value4"}
2 {"a":1,"b":2} {"c":3,"d":4}
3 {"x":"hello","y":"world"} {"alice":"cream","z":"!"}

query
SELECT
  id,
  VARIANT_MAP_CAT(map1, map2) AS concatenated_map
FROM
  map_cat_test;
----
1 {"key1":"value1","key2":"value2","key3":"value3","key4":"value4"}
2 {"a":1,"b":2,"c":3,"d":4}
3 {"alice":"cream","x":"hello","y":"world","z":"!"}
